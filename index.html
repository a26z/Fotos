<!doctype html>
<html lang="de">

<head>
	<meta charset="utf-8">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<title>Fotos</title>
</head>

<body>
	<main>
		<article class="container"></article>
		<article class="modal">
			<section class="modal-wrapper">
				<figure class="content">
					<img id="modalimage" alt="Modal Image">
				</figure>
				<figcaption class="modal-caption"></figcaption>
				<span class="close">&times;</span>
			</section>
		</article>
		<div id="test"></div>
	</main>
	<!-- ============== Javascript ============== -->
	<script type="module">
		import { images } from './js/images.js';

		let docFragment = new DocumentFragment();

		// ------------------------------------------------------------- gallery

		images.forEach(pic => {
			let figure = document.createElement("FIGURE");
			let caption = document.createElement("FIGCAPTION");
			caption.className = 'gallery-caption';
			figure.className = 'magnify';
			figure.id = pic.alt;
			let image = document.createElement("IMG");
			image.src = pic.path;
			image.classList.add('vorschau', 'trigger');
			image.setAttribute("alt", pic.alt);
			image.setAttribute("data-caption", pic.caption)
			figure.appendChild(image);
			figure.appendChild(caption);
			let captionText = document.createTextNode(pic.alt);
			caption.appendChild(captionText);
            docFragment.appendChild(figure);
		});

        document.querySelector('.container').appendChild(docFragment);

		// ------------------------------------------------------------- modal

		const modal = document.querySelector(".modal");
		const close = document.querySelector(".close");
		let caption; // undefined

		function toggleModal() {
			if(caption) caption.parentNode.removeChild(caption);
			let image = document.getElementById("modalimage");
			image.src = this.src;
			document.querySelector(".content").appendChild(image);
			caption = document.createTextNode(this.dataset.caption)
			document.querySelector(".modal-caption").appendChild(caption);
			modal.classList.toggle("show-modal");
		}

		document.querySelectorAll(".trigger").forEach(pic => {
			pic.addEventListener("click", toggleModal)
		})

		close.addEventListener("click", function() {
			modal.classList.toggle("show-modal")
		});

		window.addEventListener("click", function(e) {
			if(e.target === modal) modal.classList.toggle("show-modal")
		})
	</script>
</body>

</html>
